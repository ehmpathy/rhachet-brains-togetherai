# roadmap: rhachet-brains-togetherai

> ordered execution checklist with behavioral acceptance at each step

---

## phase 0: verify model ids

> confirm together ai model ids are accurate before any code changes

**read before start:**
- `.behavior/v2026_02_13.together-ai/3.1.research.access._.v1.i1.md`
- `.behavior/v2026_02_13.together-ai/3.3.blueprint.v1.i1.md` (section 6: model catalog)

**checklist:**
- [ ] query `https://api.together.xyz/v1/models` (or `together ai models` docs page) for each of the 10 model ids in the blueprint
- [ ] confirm exact model id strings (e.g., `Qwen/Qwen3-Coder-Next`, `deepseek-ai/DeepSeek-V3`, etc.)
- [ ] confirm each model supports `json_schema` or `json_object` response format
- [ ] note any corrections needed to blueprint model catalog

**acceptance:**
- all 10 model ids are confirmed valid on together ai
- any corrections are documented

**verify:** manual review of api response or docs page

---

## phase 1: replace model catalog (`BrainAtom.config.ts`)

> swap the xai slug union and config entries for together ai models

**read before start:**
- `.behavior/v2026_02_13.together-ai/3.3.blueprint.v1.i1.md` (section 3.2 + section 6)
- `.behavior/v2026_02_13.together-ai/1.vision.md` (available brains table)

**depends on:** phase 0

**checklist:**
- [ ] rename `XaiBrainAtomSlug` -> `TogetherBrainAtomSlug`
- [ ] replace slug union with 10 together ai slugs
- [ ] delete all 8 `xai/grok/*` config entries
- [ ] create 10 `together/*` config entries with:
  - correct `model` id (from phase 0)
  - correct `description`
  - correct `BrainSpec` (rates from research doc, context, swe-bench grades, domain, cutoff)
  - cache fields set to `$0` (together ai has no cache rate)
- [ ] update `CONFIG_BY_ATOM_SLUG` record type to `Record<TogetherBrainAtomSlug, BrainAtomConfig>`
- [ ] update jsdoc `.sources` to reference together ai docs and rate pages

**acceptance:**
- `TogetherBrainAtomSlug` is a union of exactly 10 slugs
- `CONFIG_BY_ATOM_SLUG` has an entry for each slug
- each entry has a valid `BrainSpec` with rates that match together ai serverless rates
- `npm run test:types` passes

**verify:** `npm run test:types`

---

## phase 2: update factory (`genBrainAtom.ts`)

> point the factory at together ai's api

**read before start:**
- `.behavior/v2026_02_13.together-ai/3.3.blueprint.v1.i1.md` (section 3.3)
- `.behavior/v2026_02_13.together-ai/3.1.research.access._.v1.i1.md` (section 2: api access)

**depends on:** phase 1

**checklist:**
- [ ] update type re-export: `XaiBrainAtomSlug` -> `TogetherBrainAtomSlug`
- [ ] update `repo` from `'xai'` to `'together'`
- [ ] update `baseURL` from `'https://api.x.ai/v1'` to `'https://api.together.xyz/v1'`
- [ ] update env var from `XAI_API_KEY` to `TOGETHER_API_KEY`
- [ ] update jsdoc (.what, .note, .example) to reference together-ai
- [ ] retain entire `ask()` implementation (openai-compatible, no changes needed)

**acceptance:**
- factory creates atoms with `repo === 'together'`
- openai client points to `api.together.xyz/v1`
- reads `TOGETHER_API_KEY` from env
- `npm run test:types` passes

**verify:** `npm run test:types`

---

## phase 3: update sdk contract (`src/contract/sdk/index.ts`)

> rename the aggregator function and update the slug list

**read before start:**
- `.behavior/v2026_02_13.together-ai/3.3.blueprint.v1.i1.md` (section 3.4)

**depends on:** phase 2

**checklist:**
- [ ] rename `getBrainAtomsByXAI` -> `getBrainAtomsByTogetherAI`
- [ ] replace 8 xai slug calls with 10 together ai slug calls
- [ ] update jsdoc to reference together-ai
- [ ] retain `genBrainAtom` re-export

**acceptance:**
- `getBrainAtomsByTogetherAI()` returns exactly 10 `BrainAtom` instances
- each atom has a valid `together/*` slug
- `npm run test:types` passes

**verify:** `npm run test:types`

---

## phase 4: update unit tests

> prove the sdk contract via unit tests

**read before start:**
- `.behavior/v2026_02_13.together-ai/3.3.blueprint.v1.i1.md` (section 3.5 + section 7.1)
- `.behavior/v2026_02_13.together-ai/2.1.criteria.blackbox.md` (usecase.1 + usecase.8)

**depends on:** phase 3

**checklist:**
- [ ] update describe label to `'rhachet-brains-togetherai.unit'`
- [ ] update case1: `getBrainAtomsByTogetherAI` returns 10 atoms
- [ ] update case1: slug check includes `'together/qwen3/coder-next'`
- [ ] update case2: factory with slug `'together/qwen3/coder-next'`
- [ ] update case2: repo assertion `'together'`
- [ ] retain given/when/then structure and BrainAtom instanceof checks

**acceptance:**
- `npm run test:unit` passes
- all 6 assertions green

**verify:** `THOROUGH=true npm run test:unit`

---

## phase 5: update integration tests

> prove live api access via integration tests

**read before start:**
- `.behavior/v2026_02_13.together-ai/3.3.blueprint.v1.i1.md` (section 3.6 + section 7.2)
- `.behavior/v2026_02_13.together-ai/2.1.criteria.blackbox.md` (usecase.2 + usecase.3 + usecase.4 + usecase.5)

**depends on:** phase 4

**checklist:**
- [ ] update env var guard: `TOGETHER_API_KEY` check with clear error message
- [ ] update slug to `'together/qwen3/coder-next'`
- [ ] update case1 assertions: `repo === 'together'`, slug matches
- [ ] retain case2 (ask with prompt, ask with briefs) — provider-agnostic
- [ ] retain case3 (episode creation, episode continuation) — provider-agnostic
- [ ] retain test assets (`secret-code.brief.md`)

**acceptance:**
- `npm run test:integration` passes with `TOGETHER_API_KEY` set
- case2/t0: response contains content, tokens > 0, cash costs defined
- case2/t1: response contains ZEBRA42 from brief
- case3/t0: episode has 1 exchange
- case3/t1: continuation remembers PAPAYA99, episode has 2 exchanges

**verify:** `source .agent/repo=.this/role=any/skills/use.apikeys.sh && THOROUGH=true npm run test:integration`

---

## phase 6: update package identity

> rebrand the package from xai to together-ai

**read before start:**
- `.behavior/v2026_02_13.together-ai/3.3.blueprint.v1.i1.md` (section 3.1)

**depends on:** phase 5

**checklist:**
- [ ] update `name` to `"rhachet-brains-togetherai"`
- [ ] update `description` to `"rhachet brain.atom adapter for together ai open-source models"`
- [ ] update `repository` to `"ehmpathy/rhachet-brains-togetherai"`
- [ ] update `homepage` url
- [ ] update `bugs` url
- [ ] update `keywords` to `["together", "togetherai", "qwen", "deepseek", "llama", "open-source", "rhachet", "brain", "llm", "ai"]`
- [ ] set `version` to `"0.0.1"`

**acceptance:**
- `npm run build` succeeds
- package identity fields are correct

**verify:** `npm run build`

---

## phase 7: rewrite readme

> document the new adapter for consumers

**read before start:**
- `.behavior/v2026_02_13.together-ai/3.3.blueprint.v1.i1.md` (section 3.7 + section 6)
- `.behavior/v2026_02_13.together-ai/1.vision.md` (user experience, available brains)
- `.behavior/v2026_02_13.together-ai/2.1.criteria.blackbox.md` (usecase.6: drop-in replacement)

**depends on:** phase 6

**checklist:**
- [ ] title: `rhachet-brains-togetherai`
- [ ] description: rhachet brain.atom adapter for together ai open-source models
- [ ] install section: `npm install rhachet-brains-togetherai`
- [ ] usage section: `genBrainAtom({ slug: 'together/qwen3/coder-next' })` with structured output example
- [ ] available brains table: all 10 models with slug, model id, context, swe-bench, input rate, output rate
- [ ] environment section: `TOGETHER_API_KEY`
- [ ] sources section: together ai docs, models page, rate page

**acceptance:**
- readme accurately reflects all 10 models and their specs
- install and usage examples use correct package name and slugs
- env var is `TOGETHER_API_KEY`

**verify:** manual review

---

## phase 8: full build and test sweep

> final validation that the full conversion works end-to-end

**read before start:**
- `.behavior/v2026_02_13.together-ai/2.1.criteria.blackbox.md` (all usecases)

**depends on:** phase 7

**checklist:**
- [ ] `npm run test:types` — types compile clean
- [ ] `npm run test:format` — format is clean
- [ ] `npm run test:lint` — lint is clean
- [ ] `THOROUGH=true npm run test:unit` — all unit tests pass
- [ ] `source .agent/repo=.this/role=any/skills/use.apikeys.sh && THOROUGH=true npm run test:integration` — all integration tests pass
- [ ] `npm run build` — build succeeds
- [ ] no stale references to `xai`, `grok`, or `XAI_API_KEY` left in `src/`

**acceptance:**
- zero test failures
- zero type errors
- zero lint errors
- build produces clean dist/
- no stale xai references in source code

**verify:** `source .agent/repo=.this/role=any/skills/use.apikeys.sh && npm run test`

---

## dependency graph

```
phase 0 (verify model ids)
  └── phase 1 (BrainAtom.config.ts)
        └── phase 2 (genBrainAtom.ts)
              └── phase 3 (contract/sdk/index.ts)
                    └── phase 4 (unit tests)
                          └── phase 5 (integration tests)
                                └── phase 6 (package.json)
                                      └── phase 7 (readme.md)
                                            └── phase 8 (full sweep)
```

linear chain — each phase depends on the prior phase. no parallelism.
